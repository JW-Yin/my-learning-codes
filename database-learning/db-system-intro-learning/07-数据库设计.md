# 《数据库系统概论（第5版）》第七章 数据库设计大纲

## 第7章 数据库设计

### 7.1 数据库设计概述

#### 7.1.1 数据库设计的特点
- **数据库建设的基本规律**
  - "三分技术，七分管理，十二分基础数据"
  - 技术与管理的结合
- **结构（数据）设计与行为（处理）设计相结合**
  - 结构设计：设计数据库框架和数据结构
  - 行为设计：设计应用程序、事务处理等
  - 两者紧密结合，相互参照

#### 7.1.2 数据库设计方法
- **新奥尔良方法（New Orleans）**
  - 将数据库设计分为四个阶段：需求分析、概念设计、逻辑设计、物理设计
- **基于E-R模型的设计方法**
  - 采用E-R图进行概念设计
- **3NF设计方法**
  - 基于关系数据理论设计逻辑结构
- **ODL（Object Definition Language）方法**
  - 面向对象的数据库设计方法
- **计算机辅助设计工具**
  - 各种数据库设计工具和CASE工具

#### 7.1.3 数据库设计的基本步骤
- **需求分析阶段**
  - 了解用户需求，确定系统边界
  - 结果：数据字典、数据流图、需求说明书
- **概念结构设计阶段**
  - 设计概念模型，独立于具体DBMS
  - 结果：E-R图或类图
- **逻辑结构设计阶段**
  - 将概念模型转换为DBMS支持的数据模型
  - 优化数据模型
  - 结果：逻辑结构（关系模式）
- **物理结构设计阶段**
  - 确定数据的存储结构和存取方法
  - 结果：物理存储方案
- **数据库实施阶段**
  - 建立数据库，编制应用程序，组织数据入库
  - 结果：可运行的数据库系统
- **数据库运行和维护阶段**
  - 系统运行，维护和改进
  - 结果：稳定运行的数据库系统

#### 7.1.4 数据库设计过程中的各级模式
- **概念设计阶段**
  - 形成独立于机器和DBMS的概念模式（E-R图）
- **逻辑设计阶段**
  - 转换形成DBMS支持的数据模型（关系模式）
- **物理设计阶段**
  - 形成数据库的内模式
- **数据库实施阶段**
  - 建立数据库，形成模式、外模式、内模式

### 7.2 需求分析

#### 7.2.1 需求分析的任务
- **信息要求**
  - 用户需要从数据库中获得信息的内容与性质
- **处理要求**
  - 用户要完成什么处理功能，响应时间，处理方式
- **安全性与完整性要求**
  - 数据的安全性、完整性约束
- **需求分析的重点**
  - 调查、收集、分析用户在数据管理中的信息要求、处理要求、安全性与完整性要求

#### 7.2.2 需求分析的方法
- **调查组织机构情况**
  - 了解组织的部门组成、职责、业务活动
- **调查各部门的业务活动情况**
  - 了解各部门输入、输出数据、处理过程
- **协助用户明确需求**
  - 帮助用户明确各种需求
- **确定系统边界**
  - 确定哪些活动由计算机完成，哪些由人工完成
- **调查方法**
  - 跟班作业、开调查会、请专人介绍、询问、设计调查表、查阅记录

#### 7.2.3 数据字典
- **数据字典的组成**
  - **数据项**：数据的最小单位
  - **数据结构**：若干数据项的有意义集合
  - **数据流**：数据结构在系统内的传输路径
  - **数据存储**：数据结构停留或保存的地方
  - **处理过程**：处理的具体逻辑，通常用判定表或判定树描述
- **数据项描述**
  - 数据项名、含义、别名、类型、长度、取值范围、取值含义、与其他数据项的逻辑关系
- **数据字典的作用**
  - 数据定义和描述的集合
  - 数据库设计和系统分析的依据
  - 数据库管理员管理数据库的依据

### 7.3 概念结构设计

#### 7.3.1 概念模型
- **概念模型的特点**
  - 真实反映现实世界
  - 易于理解
  - 易于更改
  - 易于向关系、网状、层次等各种数据模型转换
- **概念模型的作用**
  - 数据库设计人员和用户交流的工具
  - 数据库设计的基础
  - 向各种数据模型转换的基础

#### 7.3.2 E-R模型
- **E-R模型的基本概念**
  - **实体（Entity）**：客观存在并可相互区别的事物
  - **属性（Attribute）**：实体具有的某一特性
  - **码（Key）**：唯一标识实体的属性集
  - **实体型（Entity Type）**：实体名及其属性名集合
  - **实体集（Entity Set）**：同一类型实体的集合
  - **联系（Relationship）**：实体内部或实体之间的联系
- **实体间的联系类型**
  - 一对一联系（1:1）
  - 一对多联系（1:n）
  - 多对多联系（m:n）
- **E-R图的表示方法**
  - 矩形：实体型
  - 椭圆：属性
  - 菱形：联系
  - 直线：连接实体与属性、实体与联系

#### 7.3.3 扩展的E-R模型
- **特殊化与概化**
  - **特殊化（Specialization）**：从较高层次的实体类型派生出较低层次的实体类型
  - **概化（Generalization）**：将多个实体类型的共同特征抽象为一个较高层次的实体类型
- **属性继承**
  - 高层实体类型的属性被低层实体类型继承
- **不相交约束与重叠约束**
  - 不相交：低层实体类型互不相交
  - 重叠：低层实体类型可以重叠
- **完备性约束**
  - 全部概化：高层实体必须属于某个低层实体类型
  - 部分概化：高层实体可以不属于任何低层实体类型

#### 7.3.4 UML
- **UML简介**
  - 统一建模语言（Unified Modeling Language）
  - 面向对象的建模语言
  - 适用于软件开发的各个阶段
- **类图（Class Diagram）**
  - 描述系统的静态结构
  - 类、属性、操作、关系
- **UML与E-R模型的比较**
  - UML更丰富，支持行为建模
  - E-R模型更专注于数据建模

#### 7.3.5 概念结构设计
- **设计概念结构的四类方法**
  - 自顶向下：先定义全局概念结构框架，再逐步细化
  - 自底向上：先定义各局部概念结构，再集成全局概念结构
  - 逐步扩张：先定义核心概念结构，再向外扩充
  - 混合策略：自顶向下和自底向上相结合
- **数据抽象**
  - **分类（Classification）**：定义某一类概念作为现实世界中一组对象的类型
  - **聚集（Aggregation）**：定义某一类型的组成部分
  - **概括（Generalization）**：定义类型之间的一种子集联系
- **局部视图设计**
  - 逐一设计分E-R图
  - 确定实体、属性、码、实体间的联系
- **视图的集成**
  - 合并分E-R图，生成初步E-R图
  - 消除冲突：属性冲突、命名冲突、结构冲突
  - 修改与重构：消除冗余
  - 验证整体概念结构

### 7.4 逻辑结构设计

#### 7.4.1 E-R图向关系模型的转换
- **转换内容**
  - 将实体、实体的属性、实体之间的联系转换为关系模式
- **转换原则**
  - **实体型的转换**：一个实体型转换为一个关系模式，实体属性即为关系属性，实体码即为关系码
  - **联系的转换**
    - 1:1联系：可以转换为独立的关系模式，也可以与任意一端实体合并
    - 1:n联系：可以转换为独立的关系模式，也可以与n端实体合并
    - m:n联系：转换为一个独立的关系模式，联系属性为两端实体码及联系本身的属性
    - 多元联系：转换为一个独立的关系模式
    - 自环联系：按1:1、1:n、m:n情况分别处理
  - **关系合并**：为减少系统关系个数，可将1:1联系与任意一端实体合并，或将1:n联系与n端实体合并

#### 7.4.2 数据模型的优化
- **优化方法**
  - **规范化**：确定数据依赖，对关系模式进行规范化处理
  - **水平分解**：将关系按元组分为若干子集合，提高存取效率
  - **垂直分解**：将关系按属性分为若干子关系，提高某些事务的效率
- **设计用户子模式**
  - 使用更符合用户习惯的别名
  - 对不同级别的用户定义不同的视图，保证系统的安全性
  - 简化用户对系统的使用

#### 7.4.3 设计用户子模式
- **子模式设计考虑因素**
  - 使用更符合用户习惯的别名
  - 对不同用户定义不同的视图，提高安全性
  - 简化用户对系统的使用
- **子模式的作用**
  - 提供逻辑数据独立性
  - 提高数据安全性
  - 简化用户操作

### 7.5 物理结构设计

#### 7.5.1 数据库物理设计的内容和方法
- **物理设计的任务**
  - 确定数据库的物理结构，包括存储结构和存取方法
  - 对物理结构进行评价，评价重点是时间和空间效率
- **物理设计步骤**
  - 确定数据库的物理结构
  - 评价物理结构

#### 7.5.2 关系模式存取方法选择
- **索引存取方法**
  - B+树索引：等值查询、范围查询
  - Hash索引：等值连接、等值比较
  - 聚簇索引：提高某些查询性能
- **聚簇（Cluster）**
  - 将经常一起查询的数据物理上存储在一起
  - 提高查询效率，但降低更新效率
- **选择索引存取方法的一般规则**
  - 在经常需要搜索的列上建立索引
  - 在主码上建立索引
  - 在经常用于连接的列上建立索引
  - 在经常需要根据范围搜索的列上建立索引
  - 在经常需要排序的列上建立索引

#### 7.5.3 确定数据库的存储结构
- **影响存储结构的因素**
  - 存取时间
  - 存储空间利用率
  - 维护代价
- **确定数据的存放位置**
  - 将数据分类存放，提高系统性能
  - 考虑因素：存取频率、存储时间要求、存储空间需求
- **确定系统配置**
  - DBMS产品提供配置变量、存储分配参数
  - 需要根据应用环境调整

#### 7.5.4 评价物理结构
- **评价内容**
  - 时间效率：各种操作的时间开销
  - 空间效率：存储空间利用率
  - 维护代价：维护物理结构的代价
- **评价方法**
  - 定量估算：存储空间、存取时间
  - 性能测试：模拟操作进行测试

### 7.6 数据库的实施和维护

#### 7.6.1 数据的载入和应用程序的调试
- **数据载入**
  - 人工数据准备与录入
  - 数据转换：将原有数据转换成新数据库要求的结构
  - 数据输入子系统：专门的数据录入程序
- **应用程序的调试**
  - 功能测试：测试应用程序的功能是否满足设计要求
  - 性能测试：测试应用程序的性能指标

#### 7.6.2 数据库的试运行
- **试运行的任务**
  - 实际运行应用程序，执行对数据库的各种操作
  - 测试系统的功能和性能指标
- **数据库的转储和恢复**
  - 做好数据库的转储和恢复工作，防止故障
  - 试运行阶段系统不稳定，容易发生故障

#### 7.6.3 数据库的运行和维护
- **数据库的转储和恢复**
  - 定期对数据库和日志文件进行备份
  - 发生故障时利用备份进行恢复
- **数据库的安全性、完整性控制**
  - 调整用户权限和密码
  - 调整完整性约束条件
- **数据库性能的监督、分析和改进**
  - 监测系统运行性能
  - 分析评估存储空间和响应时间
- **数据库的重组织与重构造**
  - **重组织**：按原设计要求重新安排存储位置、回收垃圾等
  - **重构造**：部分修改数据库模式和内模式

### 7.7 小结
- **数据库设计的特点**
  - 结构设计与行为设计相结合
- **数据库设计方法**
  - 新奥尔良方法、E-R方法、3NF方法等
- **数据库设计步骤**
  - 需求分析、概念设计、逻辑设计、物理设计、实施、运行维护
- **需求分析**
  - 数据字典、数据流图
- **概念结构设计**
  - E-R模型、扩展E-R模型、UML
- **逻辑结构设计**
  - E-R图向关系模型转换、数据模型优化
- **物理结构设计**
  - 存取方法选择、存储结构确定
- **数据库实施和维护**
  - 数据载入、试运行、运行维护

---
